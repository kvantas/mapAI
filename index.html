<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>An R Package for Positional Accuracy Improvement of Vector Maps • mapAI</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="An R Package for Positional Accuracy Improvement of Vector Maps">
<meta name="description" content="An R package for Positional Accuracy Improvement of Vector Maps that uses supervised learning algorithms. It uses as input a csv file with homologous points and a vector map of the area of interest in order to correct it.">
<meta property="og:description" content="An R package for Positional Accuracy Improvement of Vector Maps that uses supervised learning algorithms. It uses as input a csv file with homologous points and a vector map of the area of interest in order to correct it.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">mapAI</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/demo_data.html">Getting Started with mapAI: A Complete Workflow</a></li>
    <li><a class="dropdown-item" href="articles/pai_validation.html">Comparing PAI Methods and Validation Strategies</a></li>
    <li><a class="dropdown-item" href="articles/swiss_data.html">Advanced Analysis with Swiss Data</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="mapai">mapAI<a class="anchor" aria-label="anchor" href="#mapai"></a>
</h1></div>
<!-- badges: start -->

<p>The <code>mapAI</code> package provides a comprehensive, end-to-end toolkit in R for the <strong>Positional Accuracy Improvement (PAI)</strong> of vector maps. The package is designed for researchers and practitioners in Geoinformatics and GIS who need not only to to improve the geometric quality of vector maps but also to understand and quantify the nature of their geometric distortions.</p>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>The <code>mapAI</code> framework allows you to:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Import Data</strong>: Easily load distorted vector maps and their corresponding homologous points (GCPs).</li>
<li>
<strong>Train a Model</strong>: Select from a suite of PAI models (<code>helmert</code>, <code>lm</code>, <code>tps</code>, <code>rf</code>, <code>gam</code>) to learn the distortion pattern.</li>
<li>
<strong>Acess the Model’s Performance</strong>: Perform k-fold cross-validation to provide a robust estimate of a PAI model’s predictive performance, using both random and spatial CV methods.</li>
<li>
<strong>Correct Geometry</strong>: Apply the trained model to warp the historical map into its corrected geometric state.</li>
<li>
<strong>Analyze and Explain</strong>: Use advanced distortion analysis functions, based on Tissot’s indicatrix theory, to quantify <em>how</em> the model handles the the map’s distortions. This allows for deeper cartographic and historical insights, turning the model from a black box into an explanatory tool.</li>
<li>
<strong>Export Results</strong>: Save the corrected map to standard geospatial file formats.</li>
</ol>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of <code>mapAI</code> from <a href="https://github.com/" class="external-link">GitHub</a> using the <code>pak</code> package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("pak")</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pak.html" class="external-link">pak</a></span><span class="op">(</span><span class="st">"kvantas/mapAI"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="core-workflow-a-complete-example">Core Workflow: A Complete Example<a class="anchor" aria-label="anchor" href="#core-workflow-a-complete-example"></a>
</h2>
<p>This example demonstrates the primary workflow. We will first generate a synthetic dataset representing a distorted map and then use the package’s functions to correct it.</p>
<div class="section level3">
<h3 id="id_1-load-libraries-and-create-demo-data">1. Load Libraries and Create Demo Data<a class="anchor" aria-label="anchor" href="#id_1-load-libraries-and-create-demo-data"></a>
</h3>
<p>We begin by using <code><a href="reference/create_demo_data.html">create_demo_data()</a></code> to generate a test case with complex, noisy distortions.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://kvantas.github.io/mapAI/">mapAI</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Linking to GEOS 3.13.1, GDAL 3.10.2, PROJ 9.5.1; sf_use_s2() is TRUE</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate a shapefile and a GCPs CSV with complex noisy distortions</span></span>
<span><span class="co"># The function returns a list containing the paths to these new files.</span></span>
<span><span class="va">demo_files</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/create_demo_data.html">create_demo_data</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"complex"</span>, seed <span class="op">=</span> <span class="fl">42</span><span class="op">)</span></span>
<span><span class="co">#&gt;    -&gt; Homologous points saved to: C:\Users\User\AppData\Local\Temp\RtmpAnVXsJ/demo_gcps.csv</span></span>
<span><span class="co">#&gt;    -&gt; Distorted map saved to: C:\Users\User\AppData\Local\Temp\RtmpAnVXsJ/demo_map.shp</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="id_2-read-data-and-train-a-model">2. Read Data and Train a Model<a class="anchor" aria-label="anchor" href="#id_2-read-data-and-train-a-model"></a>
</h3>
<p>We load the generated files and train a <strong>Generalized Additive Model (<code>gam</code>)</strong>, which is ideal for capturing the smooth, non-linear distortions present in the demo data.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the homologous points (GCPs) and the distorted vector map</span></span>
<span><span class="va">gcp_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/read_gcps.html">read_gcps</a></span><span class="op">(</span>gcp_path <span class="op">=</span> <span class="va">demo_files</span><span class="op">$</span><span class="va">gcp_path</span>, crs <span class="op">=</span> <span class="fl">2100</span><span class="op">)</span></span>
<span><span class="va">map_to_correct</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/read_map.html">read_map</a></span><span class="op">(</span>shp_path <span class="op">=</span> <span class="va">demo_files</span><span class="op">$</span><span class="va">shp_path</span>, crs <span class="op">=</span> <span class="fl">2100</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Train the GAM model using the GCPs</span></span>
<span><span class="va">gam_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/train_pai_model.html">train_pai_model</a></span><span class="op">(</span><span class="va">gcp_data</span>, method <span class="op">=</span> <span class="st">"gam"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Training 'gam' model...</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="id_3-apply-correction-and-visualize">3. Apply Correction and Visualize<a class="anchor" aria-label="anchor" href="#id_3-apply-correction-and-visualize"></a>
</h3>
<p>We apply the trained model to our distorted grid. The resulting plot, which overlays the corrected grid on the original, provides a clear visual confirmation of what the model does to the distorted map.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Apply the model to the distorted map</span></span>
<span><span class="va">corrected_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/apply_pai_model.html">apply_pai_model</a></span><span class="op">(</span><span class="va">gam_model</span>, <span class="va">map_to_correct</span><span class="op">)</span></span>
<span><span class="co">#&gt; Applying PAI model to map features...</span></span>
<span><span class="co">#&gt; Correction complete.</span></span>
<span></span>
<span><span class="co"># For easy plotting, add a 'status' column and combine the maps</span></span>
<span><span class="va">map_to_correct</span><span class="op">$</span><span class="va">status</span> <span class="op">&lt;-</span> <span class="st">"Original (Distorted)"</span></span>
<span><span class="va">corrected_map</span><span class="op">$</span><span class="va">status</span> <span class="op">&lt;-</span> <span class="st">"Corrected"</span></span>
<span><span class="va">comparison_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">map_to_correct</span><span class="op">[</span>, <span class="st">"status"</span><span class="op">]</span>, <span class="va">corrected_map</span><span class="op">[</span>, <span class="st">"status"</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create the final comparison plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">comparison_data</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">status</span>, linetype <span class="op">=</span> <span class="va">status</span><span class="op">)</span>, fill <span class="op">=</span> <span class="cn">NA</span>, linewidth <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Map Status"</span>, values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Original (Distorted)"</span> <span class="op">=</span> <span class="st">"grey50"</span>, <span class="st">"Corrected"</span> <span class="op">=</span> <span class="st">"#e41a1c"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_linetype_manual</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Map Status"</span>, values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Original (Distorted)"</span> <span class="op">=</span> <span class="st">"dashed"</span>, <span class="st">"Corrected"</span> <span class="op">=</span> <span class="st">"solid"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Positional Correction of a Distorted Grid"</span>,</span>
<span>       subtitle <span class="op">=</span> <span class="st">"Overlay of original (dashed) and mapAI-corrected (solid) geometries"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-apply-and-visualize-1.png" width="100%"></p>
<hr>
</div>
</div>
<div class="section level2">
<h2 id="from-correction-to-explanation-advanced-distortion-analysis">From Correction to Explanation: Advanced Distortion Analysis<a class="anchor" aria-label="anchor" href="#from-correction-to-explanation-advanced-distortion-analysis"></a>
</h2>
<p>A key challenge with data-driven models is understanding <em>what</em> they have learned. <code>mapAI</code> directly addresses this by providing tools to “open the black box” and analyze the properties of the learned transformation.</p>
<div class="section level3">
<h3 id="id_4-quantify-and-visualize-the-distortion-field">4. Quantify and Visualize the Distortion Field<a class="anchor" aria-label="anchor" href="#id_4-quantify-and-visualize-the-distortion-field"></a>
</h3>
<p>The <code><a href="reference/analyze_distortion.html">analyze_distortion()</a></code> function computes local distortion metrics across the map space. This allows us to move from a simple visual assessment to a quantitative map of the distortion.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1. Create a grid of points for analysis using the pipe (%&gt;%)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span>
<span><span class="va">analysis_points</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_make_grid.html" class="external-link">st_make_grid</a></span><span class="op">(</span><span class="va">gcp_data</span>, n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">25</span>, <span class="fl">25</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_unary.html" class="external-link">st_centroid</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/sf.html" class="external-link">st_sf</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2. Analyze the distortion using our trained GAM model</span></span>
<span><span class="va">distortion_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/analyze_distortion.html">analyze_distortion</a></span><span class="op">(</span><span class="va">gam_model</span>, <span class="va">analysis_points</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 3. Plot the distortion surfaces</span></span>
<span><span class="va">plot_area</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/plot_distortion_surface.html">plot_distortion_surface</a></span><span class="op">(</span></span>
<span>  <span class="va">distortion_results</span>, metric <span class="op">=</span> <span class="st">"log2_area_scale"</span>, diverging <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Areal Distortion (log2σ)"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot_shear</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/plot_distortion_surface.html">plot_distortion_surface</a></span><span class="op">(</span></span>
<span>  <span class="va">distortion_results</span>, metric <span class="op">=</span> <span class="st">"max_shear"</span></span>
<span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Maximum Shear Distortion (°)"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine plots using the patchwork library</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"patchwork"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">plot_area</span> <span class="op">+</span> <span class="va">plot_shear</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="va">plot_area</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="reference/figures/README-advanced-analysis-1.png" width="100%"> These plots provide a detailed map of where the model learned to apply the most significant stretching, shrinking, and shearing, offering insights that may correlate with physical map degradation or historical cartographic techniques.</p>
<p>By providing these tools, <code>mapAI</code> empowers researchers to not only correct their historical maps with high accuracy but also to gain a deeper, quantitative understanding of their geometric properties.</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing mapAI</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Konstantinos Vantas <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-6387-8791" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/kvantas/mapAI" class="external-link"><img src="https://img.shields.io/badge/Package%20version-0.1.1-orange.svg?style=flat-square" alt="packageversion"></a></li>
<li><a href="https://doi.org/10.5281/zenodo.15767080" class="external-link"><img src="https://zenodo.org/badge/DOI/10.5281/zenodo.15767080.svg" alt="DOI"></a></li>
<li><a href="https://codecov.io/gh/kvantas/mapAI" class="external-link"><img src="https://codecov.io/gh/kvantas/mapAI/branch/master/graph/badge.svg?token=8dbGQrCCnz" alt="codecov"></a></li>
<li><a href="https://lifecycle.r-lib.org/articles/stages.html#stable" class="external-link"><img src="https://img.shields.io/badge/lifecycle-stable-brightgreen.svg" alt="Lifecycle: stable"></a></li>
<li><a href="https://github.com/kvantas/mapAI/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/kvantas/mapAI/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Konstantinos Vantas.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
